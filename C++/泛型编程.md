# 泛型编程

## 模板

模板只有在定义后才会实例化，防止重复实例化，可以通过模板声明的方式来防止。

1. 类模板和参数模板
2. 多参数模板
3. 完美转发
4. 尾置返回返回不确定的类型



​	类模板不会自动推导类型，需要在实例化时指出。

​	与非模板代码不同，模板的头文件通常既需要包括声明也包括定义。

​	sizeof...运算符用于计算可变参数包的个数



### 函数模板

​	函数模板形如：

```cpp
template <typename T>
T func(T& t1, T& t2) {
	return t1 + t2;
}
```



## lambda

### 概念

一个lambda表达式表示一个可调用的代码单元，可以理解为一个未命名的内联函数。

**可调用的对象：如果可以对其使用调用运算符（），则称它为可调用对象。**



### 定义

`[](args) ->type {func body}`

参数列表和返回类型可以省略，参数列表为空表示不需要入参，返回类型为空由编译器推断出来。

> []：表示捕获列表，使得lambda函数体内使用外部函数的局部变量
>
> (args)：参数列表
>
> ->type：尾置返回，方便返回复杂的类型，比如数组指针
>
> {}：函数体

[=]：隐式为值捕获

[&]：隐式为引用捕获



### 注意点

1. lambda不能有默认参数
2. lambda比如使用尾置返回（`func_name(args) -> type {func body}`）
3. 当以引用方式捕获一个变量时，必须保证在lambda执行时变量是存在的。
4. lambda函数中如果包含return以外的任何语句，都认为其返回void。



第4点的例子：

```C++
//false，编译器认为返回的void，实际lambda返回int类型
[] (int i) {
	if (i > 0) {
		return 1;
	}else{
		return -1;
	}
}
```



